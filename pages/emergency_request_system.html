<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Emergency Request System - Life Savers Donors</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script type="module"
        src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Flifesaver8673back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.5"></script>
</head>

<body class="bg-background">
    <!-- Navigation Header -->
    <nav class="bg-white shadow-card sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <svg class="h-10 w-10 text-primary mr-3" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                    </svg>
                    <span class="text-xl font-bold text-primary">Life Savers Donors</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="homepage_blood_donation_community_hub.html"
                        class="text-text-secondary hover:text-primary transition-smooth">Home</a>
                    <a href="blood_information_center.html"
                        class="text-text-secondary hover:text-primary transition-smooth">Learn</a>
                    <a href="emergency_request_system.html" class="text-primary font-semibold">Emergency</a>
                    <a href="success_stories_hub.html"
                        class="text-text-secondary hover:text-primary transition-smooth">Stories</a>
                    <a href="medical_information_library.html"
                        class="text-text-secondary hover:text-primary transition-smooth">Medical Info</a>
                    <button class="btn-primary">Donate Now</button>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button class="text-text-secondary hover:text-primary">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Critical Alert Banner -->
    <div class="bg-error text-white py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center">
                <svg class="h-6 w-6 mr-3 animate-pulse" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                        d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                        clip-rule="evenodd" />
                </svg>
                <span class="text-lg font-bold">EMERGENCY BLOOD REQUEST SYSTEM - IMMEDIATE RESPONSE REQUIRED</span>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="relative bg-gradient-hero text-white py-16">
        <div class="absolute inset-0 bg-black opacity-30"></div>
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="flex items-center justify-center mb-6">
                <svg class="h-16 w-16 text-white mr-4" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                </svg>
                <h1 class="text-hero">Emergency Response Center</h1>
            </div>
            <p class="text-xl mb-8 max-w-3xl mx-auto opacity-90">
                Critical blood matching platform connecting hospitals with life-saving donors in real-time. Every second
                counts when lives are on the line.
            </p>

            <!-- Quick Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button
                    class="bg-white text-primary font-bold py-4 px-8 rounded-lg hover:bg-gray-100 transition-smooth text-lg">
                    <svg class="w-6 h-6 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                            clip-rule="evenodd" />
                    </svg>
                    Hospital Request
                </button>
                <button
                    class="bg-warning text-white font-bold py-4 px-8 rounded-lg hover:bg-yellow-600 transition-smooth text-lg">
                    <svg class="w-6 h-6 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                        <path
                            d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" />
                    </svg>
                    Donor Response
                </button>
            </div>
        </div>
    </section>

    <!-- Live Emergency Requests -->
    <section class="py-12 bg-surface">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h2 class="text-section mb-2">Active Emergency Requests</h2>
                    <p class="text-text-secondary">Real-time critical blood needs requiring immediate response</p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-error rounded-full mr-2 animate-pulse"></div>
                        <span class="text-sm font-semibold text-error">LIVE</span>
                    </div>
                    <button class="btn-outline text-sm refresh-btn">
                        <svg class="w-4 h-4 mr-1 inline" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                                clip-rule="evenodd" />
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>

            <div id="emergencyRequestsContainer" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Loading state -->
                <div id="loadingState" class="col-span-2 text-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"></div>
                    <p class="text-text-secondary">Loading emergency requests...</p>
                </div>

                <!-- No requests state -->
                <div id="noRequestsState" class="col-span-2 text-center py-12 hidden">
                    <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                            clip-rule="evenodd" />
                    </svg>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">No Active Emergency Requests</h3>
                    <p class="text-text-secondary">All current blood needs have been fulfilled. Check back soon for new
                        requests.</p>
                </div>

                <!-- Dynamic requests will be inserted here -->
            </div>
        </div>
    </section>

    <!-- Hospital Request Portal -->


    <!-- Response Statistics -->
    <section class="py-16 bg-surface">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-section mb-4">Emergency Response Performance</h2>
                <p class="text-text-secondary max-w-2xl mx-auto">
                    Real-time metrics showing our community's life-saving response capabilities and success rates.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="text-center">
                    <div class="bg-white rounded-2xl p-8 shadow-card">
                        <div id="successRate" class="text-4xl font-bold text-primary mb-2">94%</div>
                        <div class="text-text-secondary mb-2">Success Rate</div>
                        <div class="text-accent text-sm">Emergency requests fulfilled</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white rounded-2xl p-8 shadow-card">
                        <div id="openRequests" class="text-4xl font-bold text-secondary mb-2">0</div>
                        <div class="text-text-secondary mb-2">Open Requests</div>
                        <div class="text-accent text-sm">Currently active requests</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white rounded-2xl p-8 shadow-card">
                        <div id="livesSaved" class="text-4xl font-bold text-accent mb-2">847</div>
                        <div class="text-text-secondary mb-2">Lives Saved</div>
                        <div class="text-accent text-sm">Through emergency system</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white rounded-2xl p-8 shadow-card">
                        <div class="text-4xl font-bold text-warning mb-2">24/7</div>
                        <div class="text-text-secondary mb-2">System Uptime</div>
                        <div class="text-accent text-sm">Always ready to help</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Mobile App Promotion -->
    <section class="py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-gradient-hero rounded-2xl p-8 lg:p-12 text-white">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <div>
                        <h2 class="text-3xl font-bold mb-4">Get Instant Emergency Alerts</h2>
                        <p class="text-xl mb-6 opacity-90">
                            Download our mobile app for push notifications when emergency blood requests match your
                            profile. Be the first to respond when lives are on the line.
                        </p>

                        <div class="flex flex-col sm:flex-row gap-4">
                            <button
                                class="bg-white text-primary font-semibold py-3 px-6 rounded-lg hover:bg-gray-100 transition-smooth">
                                <svg class="w-6 h-6 mr-2 inline" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z" />
                                </svg>
                                App Store
                            </button>
                            <button
                                class="bg-white text-primary font-semibold py-3 px-6 rounded-lg hover:bg-gray-100 transition-smooth">
                                <svg class="w-6 h-6 mr-2 inline" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.53,12.9 20.18,13.18L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z" />
                                </svg>
                                Google Play
                            </button>
                        </div>
                    </div>

                    <div class="text-center">
                        <img src="https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
                            alt="Mobile App Emergency Alerts" class="w-64 h-auto mx-auto rounded-2xl shadow-lg"
                            loading="lazy"
                            onerror="this.src='https://images.pexels.com/photos/607812/pexels-photo-607812.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'; this.onerror=null;" />
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-text-primary text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Logo and Mission -->
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center mb-4">
                        <svg class="h-8 w-8 text-primary mr-3" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                        </svg>
                        <span class="text-xl font-bold">Life Savers Donors</span>
                    </div>
                    <p class="text-gray-300 mb-4">
                        Connecting donors, recipients, and hospitals to save lives through the power of community-driven
                        blood donation.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-300 hover:text-white transition-smooth">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
                            </svg>
                        </a>
                        <a href="#" class="text-gray-300 hover:text-white transition-smooth">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z" />
                            </svg>
                        </a>
                        <a href="#" class="text-gray-300 hover:text-white transition-smooth">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.097.118.112.222.085.343-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001.012.001z" />
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="homepage_blood_donation_community_hub.html"
                                class="text-gray-300 hover:text-white transition-smooth">Home</a></li>
                        <li><a href="blood_information_center.html"
                                class="text-gray-300 hover:text-white transition-smooth">Blood Information</a></li>
                        <li><a href="emergency_request_system.html"
                                class="text-gray-300 hover:text-white transition-smooth">Emergency Requests</a></li>
                        <li><a href="success_stories_hub.html"
                                class="text-gray-300 hover:text-white transition-smooth">Success Stories</a></li>
                        <li><a href="medical_information_library.html"
                                class="text-gray-300 hover:text-white transition-smooth">Medical Library</a></li>
                    </ul>
                </div>

                <!-- Contact Info -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Emergency Contact</h3>
                    <ul class="space-y-2 text-gray-300">
                        <li class="font-bold text-primary">24/7 Emergency: (555) 123-LIFE</li>
                        <li>General Info: info@lifesaversdonors.org</li>
                        <li>Hospital Portal: hospitals@lifesaversdonors.org</li>
                        <li>Technical Support: support@lifesaversdonors.org</li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-300">
                <p>&copy; 2025 Life Savers Donors. All Rights Reserved. | Privacy Policy | Terms of Service | HIPAA
                    Compliance</p>
            </div>
        </div>
    </footer>

    <script>
        // Local proxy URL to avoid CORS issues
        const FETCH_URL = 'https://script.google.com/macros/s/AKfycbxLpA_lEmKQlxKyErcxByHFSpdNPSOZqBcgBstwgGdreXBExF4PhJF_vaCZyLT6uB4_eQ/exec';
        let isButtonActionInProgress = false; // Flag to prevent refresh during button actions



        // Override the remove function to prevent card removal when button action is in progress
        const originalRemove = Element.prototype.remove;
        Element.prototype.remove = function () {
            if (this.classList && this.classList.contains('emergency-request-card') && isButtonActionInProgress) {
                return; // Block card removal when button action is in progress
            }
            return originalRemove.call(this);
        };
        let buttonStates = new Map(); // Store button states locally

        // Emergency system functionality
        document.addEventListener('DOMContentLoaded', function () {
            // Load emergency requests on page load (only once)
            loadEmergencyRequests();

            // Add event listeners for verify and close buttons
            document.addEventListener('click', function (e) {
                if (e.target.closest('.verify-btn')) {
                    const button = e.target.closest('.verify-btn');
                    // Only allow clicking if button is not disabled
                    if (!button.disabled) {
                        isButtonActionInProgress = true; // Set flag to prevent refresh
                        const patientName = button.getAttribute('data-patient-name');
                        const bloodType = button.getAttribute('data-blood-type');
                        verifyRequest(patientName, bloodType, button);
                    }
                }

                if (e.target.closest('.close-btn')) {
                    const button = e.target.closest('.close-btn');
                    // Only allow clicking if button is not disabled
                    if (!button.disabled) {
                        isButtonActionInProgress = true; // Set flag to prevent refresh
                        const patientName = button.getAttribute('data-patient-name');
                        const bloodType = button.getAttribute('data-blood-type');
                        closeRequest(patientName, bloodType, button);
                    }
                }

                if (e.target.closest('.refresh-btn')) {
                    // Don't refresh if a button action is in progress
                    if (isButtonActionInProgress) {
                        return;
                    }

                    const refreshBtn = e.target.closest('.refresh-btn');

                    // Add loading state to refresh button
                    const originalText = refreshBtn.innerHTML;
                    refreshBtn.innerHTML = `
                        <svg class="w-4 h-4 mr-1 inline animate-spin" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                                clip-rule="evenodd" />
                        </svg>
                        Refreshing...
                    `;
                    refreshBtn.disabled = true;

                    // Load emergency requests
                    loadEmergencyRequests().finally(() => {
                        // Restore button state after loading completes
                        refreshBtn.innerHTML = originalText;
                        refreshBtn.disabled = false;
                    });
                }
            });



            // Form validation for hospital requests
            const form = document.querySelector('form');
            if (form) {
                form.addEventListener('submit', function (e) {
                    e.preventDefault();

                    // Basic validation
                    const requiredFields = form.querySelectorAll('select, input[required], textarea[required]');
                    let isValid = true;

                    requiredFields.forEach(field => {
                        if (!field.value.trim()) {
                            field.classList.add('border-error');
                            isValid = false;
                        } else {
                            field.classList.remove('border-error');
                        }
                    });

                    if (isValid) {
                        // Show success message
                        alert('Emergency request submitted successfully! Donors will be notified immediately.');
                        form.reset();
                    } else {
                        alert('Please fill in all required fields.');
                    }
                });
            }
        });

        // Function to load emergency requests from Google Sheets
        async function loadEmergencyRequests() {

            // Don't refresh if a button action is in progress (but allow initial load)
            if (isButtonActionInProgress && document.querySelectorAll('.emergency-request-card').length > 0) {
                return;
            }

            // If this is a refresh and button action is in progress, don't proceed
            if (isButtonActionInProgress) {
                return;
            }

            // Additional check: if there are cards and button action is in progress, don't refresh
            const existingCards = document.querySelectorAll('.emergency-request-card');
            if (existingCards.length > 0 && isButtonActionInProgress) {
                return;
            }

            const container = document.getElementById('emergencyRequestsContainer');
            const loadingState = document.getElementById('loadingState');
            const noRequestsState = document.getElementById('noRequestsState');

            try {
                // Show loading state
                loadingState.classList.remove('hidden');
                noRequestsState.classList.add('hidden');

                // Clear existing requests (but not if button action is in progress)
                if (!isButtonActionInProgress) {
                    const existingRequests = container.querySelectorAll('.emergency-request-card');
                    existingRequests.forEach(card => card.remove());
                } else {
                    return; // Don't proceed with the rest of the function
                }

                // Fetch data from local proxy
                const response = await fetch(FETCH_URL);
                const data = await response.json();

                if (data.success && data.requests && data.requests.length > 0) {
                    // Hide loading and no requests states
                    loadingState.classList.add('hidden');
                    noRequestsState.classList.add('hidden');

                    // Calculate and update statistics
                    updateStatistics(data.requests, data.statistics);

                    // Display each request
                    data.requests.forEach(request => {
                        const requestCard = createRequestCard(request);
                        container.appendChild(requestCard);
                    });
                } else {
                    // Show no requests state
                    loadingState.classList.add('hidden');
                    noRequestsState.classList.remove('hidden');

                    // Update statistics with empty data
                    updateStatistics([], { total: 0, open: 0, verified: 0, closed: 0 });
                }

            } catch (error) {
                console.error('Error loading emergency requests:', error);
                loadingState.classList.add('hidden');
                noRequestsState.classList.remove('hidden');
                noRequestsState.innerHTML = `
                    <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                    <h3 class="text-xl font-semibold text-text-primary mb-2">Error Loading Requests</h3>
                    <p class="text-text-secondary">Unable to load emergency requests. Please try again later.</p>
                `;
            }
        }

        // Function to create a request card
        function createRequestCard(request) {
            const card = document.createElement('div');
            card.className = 'emergency-request-card bg-white rounded-2xl p-6 shadow-card border-l-4';

            // Determine urgency level and styling
            const urgencyLevel = getUrgencyLevel(request);
            const urgencyConfig = getUrgencyConfig(urgencyLevel);

            card.classList.add(urgencyConfig.borderColor);

            // Calculate time since request
            const timeSince = calculateTimeSince(request.inquiryDate);



            // Check stored button states
            const cardKey = `${request.patientName}-${request.bloodType}`;
            const storedState = buttonStates.get(cardKey);

            // Determine button states
            let verifyButtonClass = 'btn-primary flex-1 verify-btn';
            let verifyButtonText = 'Verify';
            let verifyButtonDisabled = '';
            let closeButtonClass = 'btn-outline flex-1 close-btn';
            let closeButtonText = 'Close';
            let closeButtonDisabled = '';

            if (storedState) {
                if (storedState.verifyStatus === 'verified') {
                    verifyButtonClass = 'bg-green-600 text-white hover:bg-green-700 cursor-not-allowed flex-1 verify-btn';
                    verifyButtonText = 'Verified';
                    verifyButtonDisabled = 'disabled';
                }
                if (storedState.closeStatus === 'closed') {
                    closeButtonClass = 'bg-gray-600 text-white hover:bg-gray-700 cursor-not-allowed flex-1 close-btn';
                    closeButtonText = 'Closed';
                    closeButtonDisabled = 'disabled';
                }
            }

            card.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center">
                        <div class="${urgencyConfig.iconBg} p-3 rounded-full mr-4">
                            <svg class="w-6 h-6 ${urgencyConfig.iconColor}" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="${urgencyConfig.iconPath}" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold ${urgencyConfig.textColor}">${urgencyConfig.title} - ${request.bloodType} Blood Needed</h3>
                            <p class="text-text-secondary">Patient: ${request.patientName}</p>
                            <p class="text-text-secondary">${request.hospitalName} - ${request.additionalInfo || 'Emergency Request'}</p>
                        </div>
                    </div>
                    <span class="${urgencyConfig.badgeBg} text-white px-3 py-1 rounded-full text-sm font-semibold">${urgencyConfig.badgeText}</span>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <span class="text-sm text-text-secondary">Blood Type</span>
                        <p class="font-bold text-lg">${request.bloodType}</p>
                    </div>
                    <div>
                        <span class="text-sm text-text-secondary">Quantity Needed</span>
                        <p class="font-bold text-lg">${request.unitsRequired} Units</p>
                    </div>
                    <div>
                        <span class="text-sm text-text-secondary">Time Since Request</span>
                        <p class="font-bold text-lg ${urgencyConfig.timeColor}">${timeSince}</p>
                    </div>
                    <div>
                        <span class="text-sm text-text-secondary">Contact</span>
                        <p class="font-bold text-lg">${request.contactNumber}</p>
                    </div>
                </div>

                <div class="flex space-x-3">
                    <button class="${verifyButtonClass}" data-patient-name="${request.patientName}" data-blood-type="${request.bloodType}" ${verifyButtonDisabled}>
                        <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        ${verifyButtonText}
                    </button>
                    <button class="${closeButtonClass}" data-patient-name="${request.patientName}" data-blood-type="${request.bloodType}" ${closeButtonDisabled}>
                        <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                        ${closeButtonText}
                    </button>
                </div>
            `;

            return card;
        }

        // Function to determine urgency level
        function getUrgencyLevel(request) {
            const timeSince = new Date() - new Date(request.inquiryDate);
            const hoursSince = timeSince / (1000 * 60 * 60);

            if (hoursSince < 2) return 'critical';
            if (hoursSince < 6) return 'urgent';
            if (hoursSince < 24) return 'high';
            return 'normal';
        }

        // Function to get urgency configuration
        function getUrgencyConfig(level) {
            const configs = {
                critical: {
                    borderColor: 'border-error',
                    iconBg: 'bg-error-100',
                    iconColor: 'text-error',
                    textColor: 'text-error',
                    badgeBg: 'bg-error',
                    badgeText: 'CRITICAL',
                    timeColor: 'text-error',
                    progressColor: 'bg-error',
                    title: 'CRITICAL',
                    iconPath: 'M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z'
                },
                urgent: {
                    borderColor: 'border-warning',
                    iconBg: 'bg-warning-100',
                    iconColor: 'text-warning',
                    textColor: 'text-warning',
                    badgeBg: 'bg-warning',
                    badgeText: 'URGENT',
                    timeColor: 'text-warning',
                    progressColor: 'bg-warning',
                    title: 'URGENT',
                    iconPath: 'M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z'
                },
                high: {
                    borderColor: 'border-warning',
                    iconBg: 'bg-warning-100',
                    iconColor: 'text-warning',
                    textColor: 'text-warning',
                    badgeBg: 'bg-warning',
                    badgeText: 'HIGH',
                    timeColor: 'text-warning',
                    progressColor: 'bg-accent',
                    title: 'HIGH PRIORITY',
                    iconPath: 'M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z'
                },
                normal: {
                    borderColor: 'border-accent',
                    iconBg: 'bg-accent-100',
                    iconColor: 'text-accent',
                    textColor: 'text-accent',
                    badgeBg: 'bg-accent',
                    badgeText: 'NORMAL',
                    timeColor: 'text-accent',
                    progressColor: 'bg-accent',
                    title: 'BLOOD NEEDED',
                    iconPath: 'M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z'
                }
            };

            return configs[level] || configs.normal;
        }

        // Function to calculate time since request
        function calculateTimeSince(inquiryDate) {
            const now = new Date();
            let requestDate;

            // Handle different date formats
            if (typeof inquiryDate === 'string') {
                // Try to parse the date string
                requestDate = new Date(inquiryDate);

                // Check if the date is valid
                if (isNaN(requestDate.getTime())) {
                    // If parsing fails, try to handle common formats
                    const dateParts = inquiryDate.split(/[\/\-]/);
                    if (dateParts.length >= 3) {
                        // Try different date formats
                        requestDate = new Date(dateParts[2], dateParts[1] - 1, dateParts[0]); // DD/MM/YYYY
                        if (isNaN(requestDate.getTime())) {
                            requestDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]); // YYYY/MM/DD
                        }
                    }
                }
            } else {
                requestDate = new Date(inquiryDate);
            }

            // If still invalid, return "Unknown"
            if (isNaN(requestDate.getTime())) {
                return "Unknown";
            }

            const diffMs = now - requestDate;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

            if (diffHours < 1) {
                return `${diffMinutes} minutes`;
            } else if (diffHours < 24) {
                return `${diffHours} hours`;
            } else {
                const diffDays = Math.floor(diffHours / 24);
                return `${diffDays} days`;
            }
        }

        // Function to handle "Verified" button click
        async function verifyRequest(patientName, bloodType, button) {

            if (confirm(`Mark this ${bloodType} blood request for ${patientName} as VERIFIED?`)) {
                try {
                    // Show loading state
                    button.disabled = true;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2 inline animate-spin" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                        </svg>
                        Updating...
                    `;

                    // Prepare the data for the API call
                    const requestData = {
                        patientName: patientName,
                        bloodType: bloodType,
                        status: 'Verified'
                    };

                    // Call the Google Apps Script directly
                    const scriptUrl = 'https://script.google.com/macros/s/AKfycbxLpA_lEmKQlxKyErcxByHFSpdNPSOZqBcgBstwgGdreXBExF4PhJF_vaCZyLT6uB4_eQ/exec';

                    // Create URL-encoded form data
                    const formData = new URLSearchParams();
                    formData.append('action', 'update_status');
                    formData.append('data', JSON.stringify(requestData));

                    console.log('Sending request to:', scriptUrl);
                    console.log('Request data:', requestData);

                    const response = await fetch(scriptUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: formData.toString(),
                        redirect: 'follow'
                    });

                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);

                    const result = await response.json();

                    if (result.success) {
                        // Store reference to the card
                        const card = button.closest('.emergency-request-card');

                        // Change button appearance to show verified status
                        button.innerHTML = `
                            <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            Verified
                        `;
                        button.classList.remove('btn-primary');
                        button.classList.add('bg-green-600', 'text-white', 'hover:bg-green-700', 'cursor-not-allowed');
                        button.disabled = true;

                        // Update the status badge
                        const badge = card.querySelector('.bg-error, .bg-warning, .bg-accent');
                        if (badge) {
                            badge.textContent = 'VERIFIED';
                            badge.classList.remove('bg-error', 'bg-warning', 'bg-accent');
                            badge.classList.add('bg-green-600');
                        }

                        // Store the button state locally
                        const cardKey = `${patientName}-${bloodType}`;
                        const newState = { verifyStatus: 'verified', closeStatus: 'available' };
                        buttonStates.set(cardKey, newState);

                        // Update statistics after verification
                        const allRequests = Array.from(document.querySelectorAll('.emergency-request-card')).map(card => {
                            const patientName = card.querySelector('.verify-btn').getAttribute('data-patient-name');
                            const bloodType = card.querySelector('.verify-btn').getAttribute('data-blood-type');
                            return { patientName, bloodType };
                        });
                        updateStatistics(allRequests);

                        // Show success message
                        showSuccessMessage('Request marked as VERIFIED successfully!');

                        // Keep the card visible and don't refresh automatically
                        // The button state change is sufficient to show the action was completed

                        // Keep the flag true to prevent automatic refresh
                        // User can manually refresh if needed
                    } else {
                        // Reset button state on error
                        button.disabled = false;
                        button.innerHTML = `
                            <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                            </svg>
                            Verify
                        `;
                        showSuccessMessage('Failed to update status. Please try again.');
                        isButtonActionInProgress = false; // Reset flag on error
                    }
                } catch (error) {
                    console.error('Error updating status:', error);

                    // Reset button state on error
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        Verify
                    `;
                    showSuccessMessage('Error updating status. Please try again.');
                    isButtonActionInProgress = false; // Reset flag on error
                }
            }
        }

        // Function to handle "Closed" button click
        async function closeRequest(patientName, bloodType, button) {

            if (confirm(`Close this ${bloodType} blood request for ${patientName}?`)) {
                try {
                    // Show loading state
                    button.disabled = true;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2 inline animate-spin" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                        </svg>
                        Updating...
                    `;

                    // Prepare the data for the API call
                    const requestData = {
                        patientName: patientName,
                        bloodType: bloodType,
                        status: 'Closed'
                    };

                    // Call the Google Apps Script directly
                    const scriptUrl = 'https://script.google.com/macros/s/AKfycbxLpA_lEmKQlxKyErcxByHFSpdNPSOZqBcgBstwgGdreXBExF4PhJF_vaCZyLT6uB4_eQ/exec';

                    // Create URL-encoded form data
                    const formData = new URLSearchParams();
                    formData.append('action', 'update_status');
                    formData.append('data', JSON.stringify(requestData));

                    console.log('Sending request to:', scriptUrl);
                    console.log('Request data:', requestData);

                    const response = await fetch(scriptUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: formData.toString(),
                        redirect: 'follow'
                    });

                    console.log('Response status:', response.status);
                    console.log('Response headers:', response.headers);

                    const result = await response.json();

                    if (result.success) {
                        // Store reference to the card
                        const card = button.closest('.emergency-request-card');

                        // Change button appearance to show closed status
                        button.innerHTML = `
                            <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                            Closed
                        `;
                        button.classList.remove('btn-outline');
                        button.classList.add('bg-gray-600', 'text-white', 'hover:bg-gray-700', 'cursor-not-allowed');
                        button.disabled = true;

                        // Update the status badge
                        const badge = card.querySelector('.bg-error, .bg-warning, .bg-accent, .bg-green-600');
                        if (badge) {
                            badge.textContent = 'CLOSED';
                            badge.classList.remove('bg-error', 'bg-warning', 'bg-accent', 'bg-green-600');
                            badge.classList.add('bg-gray-600');
                        }

                        // Store the button state locally
                        const cardKey = `${patientName}-${bloodType}`;
                        const newState = { verifyStatus: 'available', closeStatus: 'closed' };
                        buttonStates.set(cardKey, newState);

                        // Update statistics after closing
                        const allRequests = Array.from(document.querySelectorAll('.emergency-request-card')).map(card => {
                            const patientName = card.querySelector('.verify-btn').getAttribute('data-patient-name');
                            const bloodType = card.querySelector('.verify-btn').getAttribute('data-blood-type');
                            return { patientName, bloodType };
                        });
                        updateStatistics(allRequests);

                        // Show success message
                        showSuccessMessage('Request marked as CLOSED successfully!');

                        // Keep the card visible and don't refresh automatically
                        // The button state change is sufficient to show the action was completed

                        // Keep the flag true to prevent automatic refresh
                        // User can manually refresh if needed
                    } else {
                        // Reset button state on error
                        button.disabled = false;
                        button.innerHTML = `
                            <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                            Close
                        `;
                        showSuccessMessage('Failed to update status. Please try again.');
                        isButtonActionInProgress = false; // Reset flag on error
                    }
                } catch (error) {
                    console.error('Error updating status:', error);

                    // Reset button state on error
                    button.disabled = false;
                    button.innerHTML = `
                        <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                        Close
                    `;
                    showSuccessMessage('Error updating status. Please try again.');
                    isButtonActionInProgress = false; // Reset flag on error
                }
            }
        }

        // Function to update statistics based on request data
        function updateStatistics(requests, statistics = null) {
            let openRequests, successRate, livesSaved;

            if (statistics) {
                // Use statistics from Google Apps Script (more accurate)
                openRequests = statistics.open;
                const totalRequests = statistics.total;
                const verifiedRequests = statistics.verified;
                const closedRequests = statistics.closed;

                successRate = totalRequests > 0 ? Math.round((closedRequests / totalRequests) * 100) : 94;
                livesSaved = closedRequests; // Show actual closed count as lives saved
            } else {
                // Fallback to local calculation (for backward compatibility)
                openRequests = requests.filter(request => {
                    const cardKey = `${request.patientName}-${request.bloodType}`;
                    const storedState = buttonStates.get(cardKey);
                    return !storedState || storedState.closeStatus !== 'closed';
                }).length;

                const totalRequests = requests.length;
                const verifiedRequests = requests.filter(request => {
                    const cardKey = `${request.patientName}-${request.bloodType}`;
                    const storedState = buttonStates.get(cardKey);
                    return storedState && storedState.verifyStatus === 'verified';
                }).length;

                successRate = totalRequests > 0 ? Math.round((verifiedRequests / totalRequests) * 100) : 94;

                const closedRequests = requests.filter(request => {
                    const cardKey = `${request.patientName}-${request.bloodType}`;
                    const storedState = buttonStates.get(cardKey);
                    return storedState && storedState.closeStatus === 'closed';
                }).length;
                livesSaved = closedRequests * 3;
            }

            // Update the DOM elements
            const openRequestsElement = document.getElementById('openRequests');
            const successRateElement = document.getElementById('successRate');
            const livesSavedElement = document.getElementById('livesSaved');

            if (openRequestsElement) {
                openRequestsElement.textContent = openRequests;
            }
            if (successRateElement) {
                successRateElement.textContent = successRate + '%';
            }
            if (livesSavedElement) {
                livesSavedElement.textContent = livesSaved;
            }
        }

        // Function to show success message without using alert
        function showSuccessMessage(message) {
            // Create a temporary success message element
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10B981;
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 0.5rem;
                z-index: 9999;
                font-weight: 600;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                animation: slideIn 0.3s ease-out;
            `;
            successDiv.textContent = message;

            // Add animation CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(successDiv);

            // Remove the message after 3 seconds
            setTimeout(() => {
                successDiv.remove();
                style.remove();
            }, 3000);
        }
    </script>
    <script id="dhws-dataInjector" src="../public/dhws-data-injector.js">    </script>
    <script src="../scripts/mobile-menu.js"></script>
</body>

</html>